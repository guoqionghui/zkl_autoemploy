{"version":3,"sources":["js/module/public/mui.dtpicker.js"],"names":["$","document","dom","str","Array","length","slice","call","__create_dom_div__","createElement","innerHTML","childNodes","domBuffer","DtPicker","Class","extend","init","options","self","this","_picker","body","appendChild","picker","ui","mask","createMask","ok","cancel","y","m","d","h","i","labels","addEventListener","hide","rs","callback","getSelected","e","beginMonth","endMonth","_createMonth","_createDay","_createHours","_createMinutes","_create","EVENT_START","event","preventDefault","EVENT_MOVE","type","selected","getSelectedItem","toString","value","text","setSelectedValue","parsedValue","_parseValue","isLeapYear","year","_inArray","array","item","index","_item","getDayNum","month","_fill","num","_isBeginYear","beginYear","parseInt","getSelectedValue","_isBeginMonth","_isBeginDay","beginDay","_isBeginHours","beginHours","_isEndYear","endYear","_isEndMonth","_isEndDay","endDay","_isEndHours","endHours","_createYear","current","yArray","customData","yBegin","yEnd","push","setItems","mArray","maxMonth","val","dArray","maxDay","hArray","maxHours","iArray","beginMinutes","maxMinutes","endMinutes","_setLabels","each","label","innerText","_setButtons","buttons","parts","replace","split","now","Date","getFullYear","getMonth","getDate","getHours","getMinutes","beginDate","isNaN","valueOf","endDate","setAttribute","show","noop","classList","add","className","__back","back","disposed","remove","close","dispose","setTimeout","parentNode","removeChild","name","mui"],"mappings":"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","file":"js/module/public/mui.dtpicker.js","sourcesContent":["/**\n * 日期时间插件\n * varstion 1.0.5\n * by Houfeng\n * Houfeng@DCloud.io\n */\n\n(function($, document) {\n\n\t//创建 DOM\n\t$.dom = function(str) {\n\t\tif (typeof(str) !== 'string') {\n\t\t\tif ((str instanceof Array) || (str[0] && str.length)) {\n\t\t\t\treturn [].slice.call(str);\n\t\t\t} else {\n\t\t\t\treturn [str];\n\t\t\t}\n\t\t}\n\t\tif (!$.__create_dom_div__) {\n\t\t\t$.__create_dom_div__ = document.createElement('div');\n\t\t}\n\t\t$.__create_dom_div__.innerHTML = str;\n\t\treturn [].slice.call($.__create_dom_div__.childNodes);\n\t};\n\n\tvar domBuffer = '<div class=\"mui-dtpicker\" data-type=\"datetime\">\\\n\t\t<div class=\"mui-dtpicker-header\">\\\n\t\t\t<button data-id=\"btn-cancel\" class=\"mui-btn\">取消</button>\\\n\t\t\t<button data-id=\"btn-ok\" class=\"mui-btn mui-btn-blue\">确定</button>\\\n\t\t</div>\\\n\t\t<div class=\"mui-dtpicker-title\"><h5 data-id=\"title-y\">年</h5><h5 data-id=\"title-m\">月</h5><h5 data-id=\"title-d\">日</h5><h5 data-id=\"title-h\">时</h5><h5 data-id=\"title-i\">分</h5></div>\\\n\t\t<div class=\"mui-dtpicker-body\">\\\n\t\t\t<div data-id=\"picker-y\" class=\"mui-picker\">\\\n\t\t\t\t<div class=\"mui-picker-inner\">\\\n\t\t\t\t\t<div class=\"mui-pciker-rule mui-pciker-rule-ft\"></div>\\\n\t\t\t\t\t<ul class=\"mui-pciker-list\">\\\n\t\t\t\t\t</ul>\\\n\t\t\t\t\t<div class=\"mui-pciker-rule mui-pciker-rule-bg\"></div>\\\n\t\t\t\t</div>\\\n\t\t\t</div>\\\n\t\t\t<div data-id=\"picker-m\" class=\"mui-picker\">\\\n\t\t\t\t<div class=\"mui-picker-inner\">\\\n\t\t\t\t\t<div class=\"mui-pciker-rule mui-pciker-rule-ft\"></div>\\\n\t\t\t\t\t<ul class=\"mui-pciker-list\">\\\n\t\t\t\t\t</ul>\\\n\t\t\t\t\t<div class=\"mui-pciker-rule mui-pciker-rule-bg\"></div>\\\n\t\t\t\t</div>\\\n\t\t\t</div>\\\n\t\t\t<div data-id=\"picker-d\" class=\"mui-picker\">\\\n\t\t\t\t<div class=\"mui-picker-inner\">\\\n\t\t\t\t\t<div class=\"mui-pciker-rule mui-pciker-rule-ft\"></div>\\\n\t\t\t\t\t<ul class=\"mui-pciker-list\">\\\n\t\t\t\t\t</ul>\\\n\t\t\t\t\t<div class=\"mui-pciker-rule mui-pciker-rule-bg\"></div>\\\n\t\t\t\t</div>\\\n\t\t\t</div>\\\n\t\t\t<div data-id=\"picker-h\" class=\"mui-picker\">\\\n\t\t\t\t<div class=\"mui-picker-inner\">\\\n\t\t\t\t\t<div class=\"mui-pciker-rule mui-pciker-rule-ft\"></div>\\\n\t\t\t\t\t<ul class=\"mui-pciker-list\">\\\n\t\t\t\t\t</ul>\\\n\t\t\t\t\t<div class=\"mui-pciker-rule mui-pciker-rule-bg\"></div>\\\n\t\t\t\t</div>\\\n\t\t\t</div>\\\n\t\t\t<div data-id=\"picker-i\" class=\"mui-picker\">\\\n\t\t\t\t<div class=\"mui-picker-inner\">\\\n\t\t\t\t\t<div class=\"mui-pciker-rule mui-pciker-rule-ft\"></div>\\\n\t\t\t\t\t<ul class=\"mui-pciker-list\">\\\n\t\t\t\t\t</ul>\\\n\t\t\t\t\t<div class=\"mui-pciker-rule mui-pciker-rule-bg\"></div>\\\n\t\t\t\t</div>\\\n\t\t\t</div>\\\n\t\t</div>\\\n\t</div>';\n\n\t//plugin\n\tvar DtPicker = $.DtPicker = $.Class.extend({\n\t\tinit: function(options) {\n\t\t\tvar self = this;\n\t\t\tvar _picker = $.dom(domBuffer)[0];\n\t\t\tdocument.body.appendChild(_picker);\n\t\t\t$('[data-id*=\"picker\"]', _picker).picker();\n\t\t\tvar ui = self.ui = {\n\t\t\t\tpicker: _picker,\n\t\t\t\tmask: $.createMask(),\n\t\t\t\tok: $('[data-id=\"btn-ok\"]', _picker)[0],\n\t\t\t\tcancel: $('[data-id=\"btn-cancel\"]', _picker)[0],\n\t\t\t\ty: $('[data-id=\"picker-y\"]', _picker)[0],\n\t\t\t\tm: $('[data-id=\"picker-m\"]', _picker)[0],\n\t\t\t\td: $('[data-id=\"picker-d\"]', _picker)[0],\n\t\t\t\th: $('[data-id=\"picker-h\"]', _picker)[0],\n\t\t\t\ti: $('[data-id=\"picker-i\"]', _picker)[0],\n\t\t\t\tlabels: $('[data-id*=\"title-\"]', _picker),\n\t\t\t};\n\t\t\tui.cancel.addEventListener('tap', function() {\n\t\t\t\tself.hide();\n\t\t\t}, false);\n\t\t\tui.ok.addEventListener('tap', function() {\n\t\t\t\tvar rs = self.callback(self.getSelected());\n\t\t\t\tif (rs !== false) {\n\t\t\t\t\tself.hide();\n\t\t\t\t}\n\t\t\t}, false);\n\t\t\tui.y.addEventListener('change', function(e) { //目前的change事件容易导致级联触发\n\t\t\t\tif (self.options.beginMonth || self.options.endMonth) {\n\t\t\t\t\tself._createMonth();\n\t\t\t\t} else {\n\t\t\t\t\tself._createDay();\n\t\t\t\t}\n\t\t\t}, false);\n\t\t\tui.m.addEventListener('change', function(e) {\n\t\t\t\tself._createDay();\n\t\t\t}, false);\n\t\t\tui.d.addEventListener('change', function(e) {\n\t\t\t\tif (self.options.beginMonth || self.options.endMonth) { //仅提供了beginDate时，触发day,hours,minutes的change\n\t\t\t\t\tself._createHours();\n\t\t\t\t}\n\t\t\t}, false);\n\t\t\tui.h.addEventListener('change', function(e) {\n\t\t\t\tif (self.options.beginMonth || self.options.endMonth) {\n\t\t\t\t\tself._createMinutes();\n\t\t\t\t}\n\t\t\t}, false);\n\t\t\tui.mask[0].addEventListener('tap', function() {\n\t\t\t\tself.hide();\n\t\t\t}, false);\n\t\t\tself._create(options);\n\t\t\t//防止滚动穿透\n\t\t\tself.ui.picker.addEventListener($.EVENT_START, function(event) {\n\t\t\t\tevent.preventDefault();\n\t\t\t}, false);\n\t\t\tself.ui.picker.addEventListener($.EVENT_MOVE, function(event) {\n\t\t\t\tevent.preventDefault();\n\t\t\t}, false);\n\t\t},\n\t\tgetSelected: function() {\n\t\t\tvar self = this;\n\t\t\tvar ui = self.ui;\n\t\t\tvar type = self.options.type;\n\t\t\tvar selected = {\n\t\t\t\ttype: type,\n\t\t\t\ty: ui.y.picker.getSelectedItem(),\n\t\t\t\tm: ui.m.picker.getSelectedItem(),\n\t\t\t\td: ui.d.picker.getSelectedItem(),\n\t\t\t\th: ui.h.picker.getSelectedItem(),\n\t\t\t\ti: ui.i.picker.getSelectedItem(),\n\t\t\t\ttoString: function() {\n\t\t\t\t\treturn this.value;\n\t\t\t\t}\n\t\t\t};\n\t\t\tswitch (type) {\n\t\t\t\tcase 'datetime':\n\t\t\t\t\tselected.value = selected.y.value + '-' + selected.m.value + '-' + selected.d.value + ' ' + selected.h.value + ':' + selected.i.value;\n\t\t\t\t\tselected.text = selected.y.text + '-' + selected.m.text + '-' + selected.d.text + ' ' + selected.h.text + ':' + selected.i.text;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'date':\n\t\t\t\t\tselected.value = selected.y.value + '-' + selected.m.value + '-' + selected.d.value;\n\t\t\t\t\tselected.text = selected.y.text + '-' + selected.m.text + '-' + selected.d.text;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'time':\n\t\t\t\t\tselected.value = selected.h.value + ':' + selected.i.value;\n\t\t\t\t\tselected.text = selected.h.text + ':' + selected.i.text;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'month':\n\t\t\t\t\tselected.value = selected.y.value + '-' + selected.m.value;\n\t\t\t\t\tselected.text = selected.y.text + '-' + selected.m.text;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'hour':\n\t\t\t\t\tselected.value = selected.y.value + '-' + selected.m.value + '-' + selected.d.value + ' ' + selected.h.value;\n\t\t\t\t\tselected.text = selected.y.text + '-' + selected.m.text + '-' + selected.d.text + ' ' + selected.h.text;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn selected;\n\t\t},\n\t\tsetSelectedValue: function(value) {\n\t\t\tvar self = this;\n\t\t\tvar ui = self.ui;\n\t\t\tvar parsedValue = self._parseValue(value);\n\t\t\t//TODO 嵌套过多，因为picker的change时间是异步(考虑到性能)的，所以为了保证change之后再setSelected，目前使用回调处理\n\t\t\tui.y.picker.setSelectedValue(parsedValue.y, 0, function() {\n\t\t\t\tui.m.picker.setSelectedValue(parsedValue.m, 0, function() {\n\t\t\t\t\tui.d.picker.setSelectedValue(parsedValue.d, 0, function() {\n\t\t\t\t\t\tui.h.picker.setSelectedValue(parsedValue.h, 0, function() {\n\t\t\t\t\t\t\tui.i.picker.setSelectedValue(parsedValue.i, 0);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tisLeapYear: function(year) {\n\t\t\treturn (year % 4 == 0 && year % 100 != 0) || (year % 400 == 0);\n\t\t},\n\t\t_inArray: function(array, item) {\n\t\t\tfor (var index in array) {\n\t\t\t\tvar _item = array[index];\n\t\t\t\tif (_item === item) return true;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\tgetDayNum: function(year, month) {\n\t\t\tvar self = this;\n\t\t\tif (self._inArray([1, 3, 5, 7, 8, 10, 12], month)) {\n\t\t\t\treturn 31;\n\t\t\t} else if (self._inArray([4, 6, 9, 11], month)) {\n\t\t\t\treturn 30;\n\t\t\t} else if (self.isLeapYear(year)) {\n\t\t\t\treturn 29;\n\t\t\t} else {\n\t\t\t\treturn 28;\n\t\t\t}\n\t\t},\n\t\t_fill: function(num) {\n\t\t\tnum = num.toString();\n\t\t\tif (num.length < 2) {\n\t\t\t\tnum = 0 + num;\n\t\t\t}\n\t\t\treturn num;\n\t\t},\n\t\t_isBeginYear: function() {\n\t\t\treturn this.options.beginYear === parseInt(this.ui.y.picker.getSelectedValue());\n\t\t},\n\t\t_isBeginMonth: function() {\n\t\t\treturn this.options.beginMonth && this._isBeginYear() && this.options.beginMonth === parseInt(this.ui.m.picker.getSelectedValue());\n\t\t},\n\t\t_isBeginDay: function() {\n\t\t\treturn this._isBeginMonth() && this.options.beginDay === parseInt(this.ui.d.picker.getSelectedValue());\n\t\t},\n\t\t_isBeginHours: function() {\n\t\t\treturn this._isBeginDay() && this.options.beginHours === parseInt(this.ui.h.picker.getSelectedValue());\n\t\t},\n\t\t_isEndYear: function() {\n\t\t\treturn this.options.endYear === parseInt(this.ui.y.picker.getSelectedValue());\n\t\t},\n\t\t_isEndMonth: function() {\n\t\t\treturn this.options.endMonth && this._isEndYear() && this.options.endMonth === parseInt(this.ui.m.picker.getSelectedValue());\n\t\t},\n\t\t_isEndDay: function() {\n\t\t\treturn this._isEndMonth() && this.options.endDay === parseInt(this.ui.d.picker.getSelectedValue());\n\t\t},\n\t\t_isEndHours: function() {\n\t\t\treturn this._isEndDay() && this.options.endHours === parseInt(this.ui.h.picker.getSelectedValue());\n\t\t},\n\t\t_createYear: function(current) {\n\t\t\tvar self = this;\n\t\t\tvar options = self.options;\n\t\t\tvar ui = self.ui;\n\t\t\t//生成年列表\n\t\t\tvar yArray = [];\n\t\t\tif (options.customData.y) {\n\t\t\t\tyArray = options.customData.y;\n\t\t\t} else {\n\t\t\t\tvar yBegin = options.beginYear;\n\t\t\t\tvar yEnd = options.endYear;\n\t\t\t\tfor (var y = yBegin; y <= yEnd; y++) {\n\t\t\t\t\tyArray.push({\n\t\t\t\t\t\ttext: y + '',\n\t\t\t\t\t\tvalue: y\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tui.y.picker.setItems(yArray);\n\t\t\t//ui.y.picker.setSelectedValue(current);\n\t\t},\n\t\t_createMonth: function(current) {\n\t\t\tvar self = this;\n\t\t\tvar options = self.options;\n\t\t\tvar ui = self.ui;\n\n\t\t\t//生成月列表\n\t\t\tvar mArray = [];\n\t\t\tif (options.customData.m) {\n\t\t\t\tmArray = options.customData.m;\n\t\t\t} else {\n\t\t\t\tvar m = options.beginMonth && self._isBeginYear() ? options.beginMonth : 1;\n\t\t\t\tvar maxMonth = options.endMonth && self._isEndYear() ? options.endMonth : 12;\n\t\t\t\tfor (; m <= maxMonth; m++) {\n\t\t\t\t\tvar val = self._fill(m);\n\t\t\t\t\tmArray.push({\n\t\t\t\t\t\ttext: val,\n\t\t\t\t\t\tvalue: val\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tui.m.picker.setItems(mArray);\n\t\t\t//ui.m.picker.setSelectedValue(current);\n\t\t},\n\t\t_createDay: function(current) {\n\t\t\tvar self = this;\n\t\t\tvar options = self.options;\n\t\t\tvar ui = self.ui;\n\n\t\t\t//生成日列表\n\t\t\tvar dArray = [];\n\t\t\tif (options.customData.d) {\n\t\t\t\tdArray = options.customData.d;\n\t\t\t} else {\n\t\t\t\tvar d = self._isBeginMonth() ? options.beginDay : 1;\n\t\t\t\tvar maxDay = self._isEndMonth() ? options.endDay : self.getDayNum(parseInt(this.ui.y.picker.getSelectedValue()), parseInt(this.ui.m.picker.getSelectedValue()));\n\t\t\t\tfor (; d <= maxDay; d++) {\n\t\t\t\t\tvar val = self._fill(d);\n\t\t\t\t\tdArray.push({\n\t\t\t\t\t\ttext: val,\n\t\t\t\t\t\tvalue: val\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tui.d.picker.setItems(dArray);\n\t\t\tcurrent = current || ui.d.picker.getSelectedValue();\n\t\t\t//ui.d.picker.setSelectedValue(current);\n\t\t},\n\t\t_createHours: function(current) {\n\t\t\tvar self = this;\n\t\t\tvar options = self.options;\n\t\t\tvar ui = self.ui;\n\t\t\t//生成时列表\n\t\t\tvar hArray = [];\n\t\t\tif (options.customData.h) {\n\t\t\t\thArray = options.customData.h;\n\t\t\t} else {\n\t\t\t\tvar h = self._isBeginDay() ? options.beginHours : 0;\n\t\t\t\tvar maxHours = self._isEndDay() ? options.endHours : 23;\n\t\t\t\tfor (; h <= maxHours; h++) {\n\t\t\t\t\tvar val = self._fill(h);\n\t\t\t\t\thArray.push({\n\t\t\t\t\t\ttext: val,\n\t\t\t\t\t\tvalue: val\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tui.h.picker.setItems(hArray);\n\t\t\t//ui.h.picker.setSelectedValue(current);\n\t\t},\n\t\t_createMinutes: function(current) {\n\t\t\tvar self = this;\n\t\t\tvar options = self.options;\n\t\t\tvar ui = self.ui;\n\n\t\t\t//生成分列表\n\t\t\tvar iArray = [];\n\t\t\tif (options.customData.i) {\n\t\t\t\tiArray = options.customData.i;\n\t\t\t} else {\n\t\t\t\tvar i = self._isBeginHours() ? options.beginMinutes : 0;\n\t\t\t\tvar maxMinutes = self._isEndHours() ? options.endMinutes : 59;\n\t\t\t\tfor (; i <= maxMinutes; i++) {\n\t\t\t\t\tvar val = self._fill(i);\n\t\t\t\t\tiArray.push({\n\t\t\t\t\t\ttext: val,\n\t\t\t\t\t\tvalue: val\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tui.i.picker.setItems(iArray);\n\t\t\t//ui.i.picker.setSelectedValue(current);\n\t\t},\n\t\t_setLabels: function() {\n\t\t\tvar self = this;\n\t\t\tvar options = self.options;\n\t\t\tvar ui = self.ui;\n\t\t\tui.labels.each(function(i, label) {\n\t\t\t\tlabel.innerText = options.labels[i];\n\t\t\t});\n\t\t},\n\t\t_setButtons: function() {\n\t\t\tvar self = this;\n\t\t\tvar options = self.options;\n\t\t\tvar ui = self.ui;\n\t\t\tui.cancel.innerText = options.buttons[0];\n\t\t\tui.ok.innerText = options.buttons[1];\n\t\t},\n\t\t_parseValue: function(value) {\n\t\t\tvar self = this;\n\t\t\tvar rs = {};\n\t\t\tif (value) {\n\t\t\t\tvar parts = value.replace(\":\", \"-\").replace(\" \", \"-\").split(\"-\");\n\t\t\t\trs.y = parts[0];\n\t\t\t\trs.m = parts[1];\n\t\t\t\trs.d = parts[2];\n\t\t\t\trs.h = parts[3];\n\t\t\t\trs.i = parts[4];\n\t\t\t} else {\n\t\t\t\tvar now = new Date();\n\t\t\t\trs.y = now.getFullYear();\n\t\t\t\trs.m = now.getMonth() + 1;\n\t\t\t\trs.d = now.getDate();\n\t\t\t\trs.h = now.getHours();\n\t\t\t\trs.i = now.getMinutes();\n\t\t\t}\n\t\t\treturn rs;\n\t\t},\n\t\t_create: function(options) {\n\t\t\tvar self = this;\n\t\t\toptions = options || {};\n\t\t\toptions.labels = options.labels || ['年', '月', '日', '时', '分'];\n\t\t\toptions.buttons = options.buttons || ['取消', '确定'];\n\t\t\toptions.type = options.type || 'datetime';\n\t\t\toptions.customData = options.customData || {};\n\t\t\tself.options = options;\n\t\t\tvar now = new Date();\n\t\t\tvar beginDate = options.beginDate;\n\t\t\tif (beginDate instanceof Date && !isNaN(beginDate.valueOf())) { //设定了开始日期\n\t\t\t\toptions.beginYear = beginDate.getFullYear();\n\t\t\t\toptions.beginMonth = beginDate.getMonth() + 1;\n\t\t\t\toptions.beginDay = beginDate.getDate();\n\t\t\t\toptions.beginHours = beginDate.getHours();\n\t\t\t\toptions.beginMinutes = beginDate.getMinutes();\n\t\t\t}\n\t\t\tvar endDate = options.endDate;\n\t\t\tif (endDate instanceof Date && !isNaN(endDate.valueOf())) { //设定了结束日期\n\t\t\t\toptions.endYear = endDate.getFullYear();\n\t\t\t\toptions.endMonth = endDate.getMonth() + 1;\n\t\t\t\toptions.endDay = endDate.getDate();\n\t\t\t\toptions.endHours = endDate.getHours();\n\t\t\t\toptions.endMinutes = endDate.getMinutes();\n\t\t\t}\n\t\t\toptions.beginYear = options.beginYear || (now.getFullYear() - 5);\n\t\t\toptions.endYear = options.endYear || (now.getFullYear() + 5);\n\t\t\tvar ui = self.ui;\n\t\t\t//设定label\n\t\t\tself._setLabels();\n\t\t\tself._setButtons();\n\t\t\t//设定类型\n\t\t\tui.picker.setAttribute('data-type', options.type);\n\t\t\t//生成\n\t\t\tself._createYear();\n\t\t\tself._createMonth();\n\t\t\tself._createDay();\n\t\t\tself._createHours();\n\t\t\tself._createMinutes();\n\t\t\t//设定默认值\n\t\t\tself.setSelectedValue(options.value);\n\t\t},\n\t\t//显示\n\t\tshow: function(callback) {\n\t\t\tvar self = this;\n\t\t\tvar ui = self.ui;\n\t\t\tself.callback = callback || $.noop;\n\t\t\tui.mask.show();\n\t\t\tdocument.body.classList.add($.className('dtpicker-active-for-page'));\n\t\t\tui.picker.classList.add($.className('active'));\n\t\t\t//处理物理返回键\n\t\t\tself.__back = $.back;\n\t\t\t$.back = function() {\n\t\t\t\tself.hide();\n\t\t\t};\n\t\t},\n\t\thide: function() {\n\t\t\tvar self = this;\n\t\t\tif (self.disposed) return;\n\t\t\tvar ui = self.ui;\n\t\t\tui.picker.classList.remove($.className('active'));\n\t\t\tui.mask.close();\n\t\t\tdocument.body.classList.remove($.className('dtpicker-active-for-page'));\n\t\t\t//处理物理返回键\n\t\t\t$.back = self.__back;\n\t\t},\n\t\tdispose: function() {\n\t\t\tvar self = this;\n\t\t\tself.hide();\n\t\t\tsetTimeout(function() {\n\t\t\t\tself.ui.picker.parentNode.removeChild(self.ui.picker);\n\t\t\t\tfor (var name in self) {\n\t\t\t\t\tself[name] = null;\n\t\t\t\t\tdelete self[name];\n\t\t\t\t};\n\t\t\t\tself.disposed = true;\n\t\t\t}, 300);\n\t\t}\n\t});\n\n})(mui, document);"],"sourceRoot":"/source/"}