{"version":3,"sources":["js/module/main/zx_leaveBossAudit.js"],"names":["init","prePic","$","html","remove","prePicDiv","group","deleDiv","eventBind","click","slideToggle","on","this","parent","next","css","slideUp","children","eq","attr","slideDown","group1","u","o","length","onePic","onePicDiv","thisPic","show","btnArray","mui","confirm","e","index","i","find","append","gallery","slider","interval","hide","plusReady","alert","page","imgUp","clickCamera","plus","camera","getCamera","captureImage","io","resolveLocalFileSystemURL","entry","path","toLocalURL","pic","str","Number","message","clickGallery","pick","files","pic2","console","log","filter","multiple","upload1","wt","nativeUI","showWaiting","task","uploader","createUpload","server","method","t","status","responseText","close","addFile","file","src","start","window","document","addEventListener","actionSheet","cancel","buttons","title"],"mappings":"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","file":"js/module/main/zx_leaveBossAudit.js","sourcesContent":["var prePic;//保存一张预览图片\r\nvar group;//保存预览框架\r\nvar prePicDiv;//保存存放图片的容器\r\nvar deleDiv;\r\n$(function(){\r\n\tinit();\r\n})\r\nfunction init(){\r\n\tprePic=$(\".viewPic .mui-slider-item a\").html();\r\n\t$(\".viewPic .mui-slider-item a img\").remove();\r\n\tprePicDiv=$(\".viewPic .mui-slider-group\").html();\r\n\t$(\".viewPic .mui-slider-group .mui-slider-item\").remove();\r\n\tgroup=$(\".viewPic\").html();\r\n\tdeleDiv=$(\".delete\");\r\n\teventBind();\r\n\t/*发送请求，回调获取数据*/\r\n\t\r\n\t\r\n\t\r\n\r\n}\r\nfunction eventBind(){\r\n     //审批轨迹开始\r\n\t $(\"#zx_leaveBossAudit .route_title li span:nth-of-type(2)\").click(function(){\r\n\t \t$(\"#zx_leaveBossAudit .route_content\").slideToggle(\"fast\");\r\n\t });\r\n\t $(\"#zx_leaveBossAudit .route_content ul li span:nth-of-type(4)\").on(\"click\",function(){\r\n\t  \tif($(this).parent().next().css(\"display\")==\"block\"){\r\n\t  \t\t$(this).parent().next().slideUp();\r\n\t  \t\t$(this).children().eq(0).attr(\"src\",\"../../../../resources/imgs/select-right-gray.jpg\");\r\n\t  \t}\r\n\t  \telse{\r\n\t  \t\t$(this).parent().next().slideDown();\r\n\t  \t\t$(this).children().eq(0).attr(\"src\",\"../../../../resources/imgs/select-down-gray.jpg\")\r\n\t  \t}\r\n\t});\r\n\t//审批轨迹结束\r\n\t//图片预览开始\r\n\t$(\".pic_here img\").on(\"click\",function(){\r\n\t    $(\"#global-shadow\").html(\"\");\r\n\t    var group1=$(group);\r\n        var u=$(this).parent().children();\r\n        for(var o=0;o<u.length;o++){\r\n    \t\tvar onePic=$(prePic);\r\n    \t    var onePicDiv=$(prePicDiv);\r\n    \t\tonePic.attr(\"src\",u.eq(o).attr(\"src\"));\r\n    \t\tonePic.on(\"longTap\",function(){\r\n    \t\t\tvar thisPic=this;\r\n    \t\t\t$(\".delete\").show();\r\n    \t\t\t$(\".delete\").on(\"click\",function(){\r\n    \t\t\t\tvar btnArray = ['否', '是'];\r\n    \t\t\t\tmui.confirm(\"是否删除图片\",\"tip\",btnArray,function(e){\r\n    \t\t\t\t\tif(e.index==1){\r\n    \t\t\t\t\t\t$(thisPic).parent().parent().remove();\r\n    \t\t\t\t\t\tfor(var i=0;i<$(\".pic_here\").children().length;i++){\r\n    \t\t\t\t\t\t\tif($(thisPic).attr(\"src\")==$(\".pic_here\").children().eq(i).attr(\"src\")){\r\n    \t\t\t\t\t\t\t\t$(\".pic_here\").children().eq(i).remove();\r\n    \t\t\t\t\t\t\t}\r\n    \t\t\t\t\t\t}\r\n    \t\t\t\t\t}\r\n    \t\t\t\t\t\r\n    \t\t\t\t});\r\n    \t\t\t});\r\n    \t\t\r\n    \t\t\t\r\n    \t\t})\r\n    \t    onePicDiv.find(\"a\").append(onePic);\r\n    \t\tgroup1.find(\".mui-slider-group\").append(onePicDiv);\r\n    \t }\r\n    \t$(\"#global-shadow\").html(group1);\r\n    \t$(\"#global-shadow\").show();\r\n    \t\r\n\t\tvar gallery = mui('.mui-slider');\r\n\t\tgallery.slider({\r\n\t\t  interval:0//自动轮播周期，若为0则不自动播放，默认为0；\r\n\t\t});\r\n    });\r\n    //图片预览结束\r\n     $(\" #global-shadow\").click(function(){\r\n     \t$(this).html(\"\").hide();\r\n     });  \r\n}\r\n\r\n//上传附件开始\r\n\r\nif(window.plus) {\r\n\tplusReady();\r\n} else {\r\n\tdocument.addEventListener(\"plusready\", plusReady, false);\r\n}\r\n\r\nfunction plusReady() {\r\n\t// 弹出系统选择按钮框  \r\n\tmui(\"body\").on(\"tap\", \".file\", function() {\r\n\t\talert(1);\r\n\t\tpage.imgUp();\r\n\t\t\r\n\t});\r\n\tmui(\"body\").on(\"tap\", \".add\", function() {\r\n\t\tpage.imgUp();\r\n\t\t\r\n\t})\r\n\r\n}\r\n\r\nvar page = null;\r\npage = {\r\n\timgUp: function() {\r\n\t\tvar m = this;\r\n\t\tplus.nativeUI.actionSheet({\r\n\t\t\tcancel: \"取消\",\r\n\t\t\tbuttons: [{\r\n\t\t\t\t\ttitle: \"拍照\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: \"从相册中选择\"\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t}, function(e) { //1 是拍照  2 从相册中选择  \r\n\t\t\tswitch(e.index) {\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\tclickCamera();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tclickGallery();\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n}\r\n// 拍照添加文件\r\nfunction clickCamera() {\r\n\tplus.camera.getCamera().captureImage(function(e) {\r\n\t\tplus.io.resolveLocalFileSystemURL(e, function(entry) {\r\n\t\t\tvar path = entry.toLocalURL();\r\n\t\t    var pic=$(onePic).attr(\"src\",path);\r\n\t\t    var str=$(\".pic_here\").append(pic);\r\n\t\t    if(str){\r\n\t\t       $(\".badge\").html(Number($(\".badge\").html())+1);\r\n\t\t       $(\".file\").hide();\r\n\t\t       $(\".file_here\").show();\r\n\t\t       if(Number($(\".badge\").html())>1){\r\n\t\t       \t $(\".badge\").show();\r\n\t\t        }\r\n\t\t       else{\r\n\t\t       \t $(\".badge\").hide();\r\n\t\t        }\r\n\t\t       \r\n\t\t    }\r\n\t\t    else if($(\".pic_here\").children().length==0){\r\n\t\t    \t$(\".file_here\").hide();\r\n\t\t    \t$(\".file\").show();\r\n\t\t    }\r\n\t\t   \r\n\t\t}, function(e) {\r\n\t\t\tmui.alert(\"读取拍照文件错误：\" + e.message);\r\n\t\t});\r\n\r\n\t});\r\n}\r\n// 从相册添加文件\r\nfunction clickGallery() {\r\n\tplus.gallery.pick(function(path) {\r\n\t\tfor(var i in path.files){\r\n\t\t\tvar pic2=$(onePic).attr(\"src\",path.files[i]);\r\n\t\t    var str=$(\".pic_here\").append(pic2);\r\n\t\t    if(str){\r\n\t\t       $(\".badge\").html(Number($(\".badge\").html())+1);\r\n\t\t       $(\".file\").hide();\r\n\t\t       $(\".file_here\").show();\r\n\t\t       if(Number($(\".badge\").html())>1){\r\n\t\t       \t $(\".badge\").show();\r\n\t\t        }\r\n\t\t       else{\r\n\t\t       \t $(\".badge\").hide();\r\n\t\t        }\r\n\t\t    }\r\n\t\t    else if($(\".pic_here\").children().length==0){\r\n\t\t    \t$(\".file_here\").hide();\r\n\t\t    \t$(\".file\").show();\r\n\t\t    }\r\n\t\t   \r\n\t\t    \r\n\t\t    \r\n\t\t}\r\n\r\n\t},function(e) {\r\n    \tconsole.log( \"取消选择图片\" );\r\n    },{filter:\"image\",multiple:true});\r\n}\r\n//服务端接口路径\r\nvar server = \"http://www.test.cn/aaa.php\";\r\n//获取图片元素\r\nvar file = $('.bankCard');\r\n// 上传文件\r\nfunction upload1() {\r\n\tif(files.attr(\"src\") != \"../../../../resources/imgs/scanning.jpg\") {\r\n\t\tvar wt = plus.nativeUI.showWaiting();\r\n\t\tvar task = plus.uploader.createUpload(server, {\r\n\t\t\t\tmethod: \"POST\"\r\n\t\t\t},\r\n\t\t\tfunction(t, status) { //上传完成\r\n\t\t\t\tif(status == 200) {\r\n\t\t\t\t\talert(\"上传成功：\" + t.responseText);\r\n\t\t\t\t\twt.close(); //关闭等待提示按钮\r\n\t\t\t\t} else {\r\n\t\t\t\t\talert(\"上传失败：\" + status);\r\n\t\t\t\t\twt.close(); //关闭等待提示按钮\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\ttask.addFile(file.src, {});\r\n\t\ttask.start();\r\n\t}\r\n}\r\n//上传附件结束\r\n"],"sourceRoot":"/source/"}