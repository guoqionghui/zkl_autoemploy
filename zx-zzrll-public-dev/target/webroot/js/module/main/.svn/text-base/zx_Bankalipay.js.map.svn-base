{"version":3,"sources":["js/module/main/zx_Bankalipay.js"],"names":["init","Clients","postClientAjax","url","zx_bankalipayCode","getInitData","data","accountBankName","bankData","textChange","userPicker","setData","arr","key","i","length","textValue","clickEvent","$alertBankcode","$","$alertBankcodeText","$alertopenBank","$alertopenBankText","$alertBankegion","$alertBankegionText","$alertBankeType","$alertBankeTypeText","$alertBankPhone","$alertBankPhoneText","bind","vals","this","val","replace","hide","blur","Bankreg","text","BankCode","test","show","click","reg","Bankphone","sendPhone","telphonenum","messageType","validationCode","sendMessage","zx_Phonecode","getPhonecode","console","log","undefined","mui","doc","input","ready","PopPicker","cancelBtn","document","getElementsByClassName","addH2","createElement","setAttribute","innerHTML","after","showBorrowUsing","getElementById","addEventListener","event","items","value","dataset","bankcode","BankType","Openbank","userPickertype","bankCardKind","type","Bankmold","bankAccount","isVerifyinfo","onBtnback","dispose","history","go","bankCity","cardPhone","Code","attr","idNo","phoneCard","amount","payAmount","bankcount","zx_bankalipayInit","getBankalipayData","alert","inputAccount","str","num","c","substring","msincre","phoneCode","msinLess","success","sessionStorage","setItem","location","hash","message","css","timer","setInterval","clearInterval","scanBankCardInfo","cordova","sino","getBankCardInfo","result","exit","appVersion","ok","CardNumber","CardInsName","BankCardType","confirmBankCardInfo","errormsg","count","curCount","elem","self","SetRemainTime","removeAttr","BankPhone","$alertBankeTypeTetxt","getItem"],"mappings":"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","file":"js/module/main/zx_Bankalipay.js","sourcesContent":["/**\r\n * validationCode对象用于控制验证码时间\r\n * **/\r\nvar validationCode={\r\n\t\ttimer:\"null\", //timer变量，控制时间  \r\n\t\tcount:59,//间隔函数，1秒执行  \r\n\t\tcurCount:null,//当前剩余秒数  \r\n\t/****\r\n\t * ***定义验证码重发时间控制的方法**\r\n\t * ***参数elem 为按钮元素$对象\r\n\t * ***/\r\n\t\tsendMessage:function sendMessage(elem) {\r\n\t\t\tvar self=this;\r\n\t\t    self.curCount = self.count; \r\n\t\t    //设置button效果，开始计时  \r\n\t\t    elem.attr(\"disabled\", \"true\").css(\"background\",\"#c1c1c1\");;  \r\n\t\t    elem.text(self.curCount + \"s\");  \r\n\t\t    self.timer =setInterval(function(){\r\n\t\t\t    \tself.SetRemainTime(elem)\r\n\t\t\t    }, 1000); //启动计时器，1秒执行一次\r\n\t\t},  \r\n\t/****\r\n\t * ***timer处理函数，判断时间**\r\n\t * ***参数elem 为按钮元素$对象\r\n\t * ***/\r\n\t\tSetRemainTime:function(elem) {\r\n\t\t\tvar self=this;\r\n\t\t    if (self.curCount == 1) {                  \r\n\t\t        clearInterval(self.timer);//停止计时器  \r\n\t\t        elem.removeAttr(\"disabled\").css(\"background\",\"#fff\");//启用按钮  \r\n\t\t        elem.text(\"重新发送\");  \r\n\t\t    }  \r\n\t\t    else {  \r\n\t\t        self.curCount--;  \r\n\t\t        elem.text(self.curCount + \"s\");  \r\n\t\t    }  \r\n\t\t}  \r\n}\r\nvar msincre=100;//判断验证码是否有效\t\r\nvar phoneCode;//存储收到的验证码\r\nvar telphonenum=null;//存储发送验证码的手机号码\r\nvar BankType;//记录选择的开户银行\r\nvar Openbank=false; //标记开户银行是否选择\r\nvar BankCode=false;//标记银行卡是否填写\r\nvar bankCity = false;//标记开户行所在地是否选择\r\nvar bankAccount = false;//标记账户类型是否选择\r\nvar BankPhone = false;//标记手机验证码是否填写\r\nvar Bankmold;//记录选择的账户类型\r\nvar userPicker;//开户银行选择器\r\nvar userPickertype;//账户类型选择器\r\n//var Bankphone=\"18999998889\";//获取电话号码\r\nvar $alertBankcode;//监听银行卡错误  提示弹框\r\nvar $alertBankcodeText;//监听银行卡错误 提示信息\r\nvar $alertopenBank;//监听开户银行错误提示框\r\nvar $alertopenBankText;//监听开户银行错误信息\r\nvar $alertBankegion;//开户所地区错误提示框\r\nvar $alertBankegionText;//开户所地区错误信息\r\nvar $alertBankeType;//账户类型下拉选择错误提示框\r\nvar $alertBankeTypeTetxt;//账户类型下拉选择错误信息\r\nvar $alertBankPhone;//手机验证码错误提示框\r\nvar $alertBankPhoneText;//手机验证码错误信息\r\n//var phoneCard = \"4254821963188888\";\r\n//var payAmount =\"55\"; \r\nvar phoneCard = sessionStorage.getItem('Phone_card');//登录时身份证号\r\nvar payAmount = sessionStorage.getItem('payAmount');//支付金额\r\nvar Bankphone = sessionStorage.getItem(\"Phonevode\");//获取电话号码\r\n\r\n$(function(){\r\n\tmui('.mui-input-row input').input();\r\n\tinit();\r\n\tclickEvent();//点击事件初始化方法\r\n})\r\n/*初始化方法*/\r\nfunction init(){\r\n\tClients.postClientAjax(url.zx_bankalipayCode,null,getInitData);\r\n}\r\n/*证件类型回调函数方法*/\r\nfunction getInitData(data){\r\n\tvar accountBankName=data.data;\r\n    bankData=textChange(accountBankName,\"bankdesc\");\r\n    userPicker.setData(bankData);\r\n\r\n}\r\n/*选择器文本键的修改开始*/\r\nfunction textChange(arr,key){ \r\n \r\n   for(var i=0;i<arr.length;i++){\r\n   \t    var textValue=arr[i][key];\r\n   \t    delete arr[i][key];\r\n   \t  \tarr[i][\"text\"]=textValue;\r\n   \t  \r\n}\r\n  return arr;\r\n}\r\n/*页面点击事件处理方法*/\r\nfunction clickEvent(){\r\n\t$alertBankcode = $(\"#zx_bankAlipay .alertBankcode\");//银行卡错误提示框\r\n\t$alertBankcodeText = $(\"#zx_bankAlipay .alertBankcode span\");//银行卡错误提示信息\r\n\t$alertopenBank = $(\"#zx_bankAlipay .alertopenBank\");//开户银行错误提示框\r\n\t$alertopenBankText = $(\"#zx_bankAlipay .alertopenBank span\");//开户银行错误信息\r\n\t$alertBankegion = $(\"#zx_bankAlipay .alertBankegion\");//开户行所在地错误提示框\r\n\t$alertBankegionText = $(\"#zx_bankAlipay .alertBankegion span\");//开户行所在地错误信息\r\n\t$alertBankeType = $(\"#zx_bankAlipay .alertBankeType\");//账户类型下拉选择错误提示框\r\n\t$alertBankeTypeText = $(\"#zx_bankAlipay .alertBankeType span\");//账户类型下拉选择错误信息\r\n\t$alertBankPhone = $(\"#zx_bankAlipay .alertBankPhone\");//手机验证码错误提示框\r\n\t$alertBankPhoneText = $(\"#zx_bankAlipay .alertBankPhone span\");//手机验证码错误信息\r\n\t/*银行卡输入框绑定事件处理*/\r\n\t$(\"#zx_bankAlipay .card-phone\").bind(\"input\",function(){\r\n\t\tvar vals=$(this).val();\r\n\t\tvals=vals.replace(/\\D/g,'').replace(/....(?!$)/g,'$& ');//格式化银行卡号\r\n\t\t$(this).val(vals);\r\n\t\t$alertBankcode.hide();\r\n\t});\r\n\t/*手机验证码绑定处理事件*/\r\n\t$(\"#zx_bankAlipay .valCode\").bind(\"input\",function(){\r\n\t\t$alertBankPhone.hide();\r\n\t})\r\n\t/*银行卡失去焦点时校验*/\r\n\t$(\"#zx_bankAlipay .card-phone\").blur(\"input\",function(){\r\n\t\tvar vals=$(this).val();\r\n\t\tvals=vals.replace(/\\D/g,'');\r\n\t\tvar Bankreg=/^(\\d{16}|\\d{19})$/;\r\n\t\tif($(this).val()==\"\"){\r\n\t\t\t$alertBankcode.hide();\r\n\t\t\t$alertBankcodeText.text(\"请输入银行卡号\");\r\n\t\t\tBankCode=false;\r\n\t\t}else{\r\n\t\t\tif(Bankreg.test(vals)==false){\r\n\t\t\t\t$alertBankcodeText.text(\"银行卡位数不对，请输入正确的银行卡号\");\r\n\t\t\t\t$alertBankcode.show();\r\n\t\t\t\tBankCode=false;\r\n\t\t\t}else{\r\n\t\t\t\t$alertBankcode.hide();\r\n\t\t\t\tBankCode=true;\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\t/***为发送验证码按钮添加点击事件***/\r\n\t$(\"#zx_bankAlipay .countBtn\").click(function(){\r\n\t\tvar reg=/^1\\d{10}$/;//手机号码的正则表达式\r\n\t\tif(reg.test(Bankphone)){\t\r\n\t\t\tsendPhone =Bankphone;\r\n\t\t\ttelphonenum={\"telphonenum\":Bankphone,\"messageType\":\"BankCode\"};\r\n\t\t\tvalidationCode.sendMessage($(\"#zx_bankAlipay .countBtn\"));//执行验证码重发时间函数\r\n\t\t\tClients.postClientAjax(url.zx_Phonecode,telphonenum,getPhonecode);\r\n\t\t\tconsole.log(telphonenum);\r\n\t\t\t$alertBankPhone.hide();\r\n\t\t}else if(Bankphone==\"\" || Bankphone==null || Bankphone == undefined){\r\n\t\t\t$alertBankPhone.show();\r\n\t\t\t$alertBankPhoneText.text(\"手机号码不存在，无法获取验证码\");\r\n\t\t}else{\r\n\t\t\t$alertBankPhone.show();\r\n\t\t\t$alertBankPhoneText.text(\"手机号码无效，无法获取验证码\");\r\n\t\t}\r\n\t});\r\n\t/*验证码输入框失去焦点时校验*/\r\n//\t$(\"#zx_bankAlipay .valCode\").blur(\"input\",function(){\r\n//\t\tif(msincre==0){\r\n//\t\t\t$alertBankPhone.show();\r\n//\t\t\t$alertBankPhoneText.text(\"请输入有效的验证码\");\r\n//\t\t}else{\r\n//\t\t\tif($(this).val()==phoneCode){\r\n//\t\t\t\t$alertBankPhone.hide();\r\n//\t\t\t\tBankPhone=true;\r\n//\t\t\t\tclearInterval(timer);\r\n//\t\t\t\ttimer=null;\r\n//\t\t\t}else{\r\n//\t\t\t\t$alertBankPhone.show();\r\n//\t\t\t\t$alertBankPhoneText.text(\"请输入正确的验证码\");\r\n//\t\t\t\tBankPhone=false;\r\n//\t\t\t}\r\n//\t\t}\r\n//\t});\r\n\t/*下拉选择器开户银行*/\r\n\t(function(mui, doc) {\r\n\t\tmui.init();\r\n\t\tmui('.mui-input-row input').input();\r\n\t\tmui.ready(function() {\r\n\t\t\t//普通示例\r\n\t\t\tuserPicker = new mui.PopPicker()\r\n\t\t\tvar cancelBtn = document.getElementsByClassName('mui-poppicker-btn-cancel')[0];\r\n\t\t\tvar addH2 = document.createElement(\"h2\");\r\n\t\t\taddH2.setAttribute(\"class\", \"addTitle\");\r\n\t\t\taddH2.innerHTML = \"请选择开户银行\";\r\n\t\t\t$(cancelBtn).after(addH2);\r\n\t\t\t //accountBankName 开户银行类型\r\n\t\t\tvar showBorrowUsing = document.getElementById('id-bank');\r\n\t\t\tvar showBank = document.getElementById('inputMask');\r\n\t\t\tshowBorrowUsing.addEventListener('tap', function(event) {\r\n\t\t\t\tuserPicker.show(function(items) {\r\n\t\t\t\t\tshowBorrowUsing.value = items[0].text;\r\n\t\t\t\t\tshowBorrowUsing.dataset.i = items[0].bankcode;\r\n\t\t\t\t\tBankType = items[0].text;\r\n\t\t\t\t\t$alertopenBank.hide();\r\n\t\t\t\t\tOpenbank=true;\r\n\t\t\t\t\t//返回 false 可以阻止选择框的关闭\r\n\t\t\t\t});\r\n\t\t\t}, false);\r\n\t\t\tcancelBtn.addEventListener(\"tap\",function(){\r\n\t\t\t\tif(!showBorrowUsing.value){\r\n\t\t\t\t\t$alertopenBank.show();\r\n\t\t\t\t\t$alertopenBankText.text(\"请选择开户银行\")\r\n\t\t\t\t\tOpenbank=false;\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\t$alertopenBank.hide();\r\n\t\t\t\t\tOpenbank=true;\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t},false);\t\r\n\t\t});\r\n\t})(mui, document);\r\n\t/*下拉选择器账户类型*/\r\n\t(function(mui, doc) {\r\n\t\tmui.init();\r\n\t\tmui('.mui-input-row input').input();\r\n\t\tmui.ready(function() {\r\n\t\t\t//普通示例\r\n\t\t\tuserPickertype = new mui.PopPicker()\r\n\t\t\tvar cancelBtn = document.getElementsByClassName('mui-poppicker-btn-cancel')[1];\r\n\t\t\tvar addH2 = document.createElement(\"h2\");\r\n\t\t\taddH2.setAttribute(\"class\", \"addTitle\");\r\n\t\t\taddH2.innerHTML = \"请选择账户类型\";\r\n\t\t\t$(cancelBtn).after(addH2);\r\n\t\t\tuserPickertype.setData(bankCardKind); //bankCardKind 账户类型\r\n\t\t\tvar showBorrowUsing = document.getElementById('id-BankType');\r\n\t\t\tvar showBank = document.getElementById('inputMask');\r\n\t\t\tshowBorrowUsing.addEventListener('tap', function(event) {\r\n\t\t\t\tuserPickertype.show(function(items) {\r\n\t\t\t\t\tshowBorrowUsing.value = items[0].text;\r\n\t\t\t\t\tshowBorrowUsing.dataset.i = items[0].type;\r\n\t\t\t\t\tBankmold = items[0].text;\r\n\t\t\t\t\t$alertBankeType.hide();\r\n\t\t\t\t\tbankAccount=true;\r\n\t\t\t\t\t//返回 false 可以阻止选择框的关闭\r\n\t\t\t\t});\r\n\t\t\t}, false);\r\n\t\t\tcancelBtn.addEventListener(\"tap\",function(){\r\n\t\t\t\tif(!showBorrowUsing.value){\r\n\t\t\t\t\t$alertBankeType.show();\r\n\t\t\t\t\t$alertBankeTypeText.text(\"请选择账户类型\")\r\n\t\t\t\t\tbankAccount=false;\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\t$alertBankeType.hide();\r\n\t\t\t\t\tbankAccount=true;\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t},false);\t\r\n\t\t});\r\n\t})(mui, document);\r\n\t/*点击支付按钮处理事件*/\r\n\t$(\"#zx_bankAlipay .Bankbtnonclick\").click(function(){\r\n\t\tisVerifyinfo();\r\n\t})\r\n}\r\n\r\n/*返回事件监听*/\r\nfunction onBtnback(){\r\n\tuserPicker.dispose();//清空选择器\r\n\tuserPickertype.dispose();//清空选择器\r\n\thistory.go(-1);\r\n}\r\n/*校验页面输入框是否填写正确*/\r\nfunction isVerifyinfo(){\r\n\t// if(BankCode && bankAccount && BankPhone && bankCity && Openbank){\r\n\tif(BankCode && bankAccount  && bankCity && Openbank ){\r\n\t\tvar cardPhone=$(\"#cardPhone\").val().replace(/\\s/g,\"\");//卡号\r\n\t\tconsole.log(cardPhone);\r\n\t\tvar Code=$(\"#id-bank\").attr(\"data-i\");//银行卡的类型\r\n\t\t// var uBankCity=$('#UOBI-bankCity').val();\r\n\t\t// var iBankCity=$('#id-BankType').attr(\"data-i\");\r\n\t\tvar data={idNo:phoneCard,amount:payAmount,bankcount:cardPhone,bankcode:Code};\r\n\t\tClients.postClientAjax(url.zx_bankalipayInit,data,getBankalipayData);\r\n\t}else{\r\n\t\tmui.alert(\"信息有未填写或填写错误！\");\r\n\t}\r\n}\r\n/****银行卡号的格式化方法****/\r\nfunction inputAccount(){  \r\n    var str = $(\"#cardPhone\").val();  \r\n    if(str.length > num){  \r\n        var c = str.replace(/\\s/g,  \"\");\r\n        if(str != \"\" && c.length > 4 && c.length % 4 == 1){  \r\n        \t$(\"#cardPhone\").attr(\"type\",\"text\");\r\n        \t$(\"#cardPhone\").val(str.substring(0, str.length - 1)+ \" \" + str.substring(str.length - 1, str.length));  \r\n    \t}  \r\n\t} \r\n\tnum = str.length;\r\n}\r\n/*获取手机号码验证码回调*/\r\nfunction getPhonecode(data){\r\n\t msincre=299;\r\n\t phoneCode=data.data;\r\n\tconsole.log(data.data);\r\n\tmsinLess();\r\n}\r\nfunction getBankalipayData(data){\r\n\tif (data.success==true) {\r\n\t\tif (data.data==\"PY\") {\r\n\t\t\tsessionStorage.setItem(\"stutas\", \"PY\");\r\n\t\t\tlocation.hash=\"#zx_approval\";\r\n\t\t} else if(data.data == \"PI\"){\r\n\t\t\tmui.alert(data.message);\r\n\t\t\t$(\".Bankbtnonclick\").attr(\"disabled\",true).css(\"background\",\"#ccc\");\r\n\t\t} else if(data.data == \"AY\"){\r\n\t\t\tmui.alert(data.message);\r\n//\t\t\tlocation.hash=\"#zx_approval\";\r\n//\t\t\tsessionStorage.setItem(\"paystate\",data.message);\r\n\t\t}\r\n\t} else{\r\n\t\tmui.alert(data.message);\r\n\t\t//$(\".Bankbtnonclick\").attr(\"disabled\",true).css(\"background\",\"#ccc\");\r\n\t}\r\n\t\r\n}\r\n/****验证码有效计时****/\r\nfunction msinLess(){\r\n\ttimer=setInterval(function(){\r\n\t\tmsincre--;\r\n\t\tif(msincre==0){\r\n\t\t\tclearInterval(timer);\r\n\t\t\ttimer=null;\r\n\t\t}\r\n\t},1000)\r\n}\r\n//扫描身份证结束\r\n//扫描银行卡开始\r\nfunction scanBankCardInfo(){\r\n\t\tcordova.sino.getBankCardInfo(function(result){\r\n\t\t\tif(result.success){\r\n\t\t\t\tif(!result.data.exit){\r\n\t\t\t\t\t//===代表既比较类型也比较内容\r\n\t\t\t\t\tif(appVersion===\"IOS\"){\r\n\t\t\t\t\t\tif(result.data.ok){\r\n\t\t\t\t\t\t\t    //mui.confirm(\"银行卡号为：\"+result.data.CardNumber+\"\\n银行名字为\"+result.data.CardInsName,\"tip\",['否', '是'],function(e){\r\n\t\t\t\t\t\t\t    \t//if(e.index==1){\r\n\t\t\t\t\t\t\t    \t\t//if(result.data.CardInsName==\"中信银行\" || result.data.CardInsName==\"工商银行\"){\r\n\t\t\t\t\t\t\t\t\t\t   $(\"#bankcount\").val(result.data.CardNumber);//银行卡号\r\n\t\t\t\t\t\t\t\t\t\t\t$(\"#bank\").val(result.data.CardInsName);//英汉卡名字\r\n\t\t\t\t\t\t\t\t\t\t\t$(\"#AccountType\").val(result.data.BankCardType);//银行卡类型\r\n//\t\t\t\t\t\t\t\t\t\t\tif(result.data.CardInsName==\"中信银行\"){\r\n//\t\t\t\t\t\t\t\t\t\t\t\t$(\"#bank\").attr(\"bankkey\",\"CITICINDUB\");\r\n//\t\t\t\t\t\t\t\t\t\t\t}\r\n//\t\t\t\t\t\t\t\t\t\t\tif(result.data.CardInsName==\"工商银行\"){\r\n//\t\t\t\t\t\t\t\t\t\t\t\t$(\"#bank\").attr(\"bankkey\",\"INDU&COMMB\");\r\n//\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t   // }\r\n//\t\t\t\t\t\t\t    \t\telse{\r\n//\t\t\t\t\t\t\t    \t\t\tmui.alert(\"现阶段只支持中信银行和工商银行\");\r\n//\t\t\t\t\t\t\t    \t\t}\r\n\t\t\t\t\t\t\t    \t//}\r\n\t\t\t\t\t\t\t    \t\r\n\t\t\t\t\t          // })\r\n\t\t\t\t\t\t        \t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t//\talert(\"android\");\r\n\t\t\t\t\t\tcordova.sino.confirmBankCardInfo(function(result){\r\n\t\t\t\t\t\t\tif(result.success){\r\n\t\t\t\t\t\t\t\tif(result.data.ok){\r\n\t\t\t\t\t\t\t\t\t//mui.confirm(\"银行卡号为：\"+result.data.CardNumber+\"\\n银行名字为\"+result.data.CardInsName,\"tip\",['否', '是'],function(e){\r\n\t\t\t\t\t\t\t    //\tif(e.index==1){\r\n\t\t\t\t\t\t\t    \t\t//if(result.data.CardInsName==\"中信银行\" || result.data.CardInsName==\"工商银行\"){\r\n\t\t\t\t\t\t\t\t\t\t    $(\"#cardPhone\").val(result.data.CardNumber);//银行卡号\r\n\t\t\t\t\t\t\t\t\t\t\t$(\"#id-bank\").val(result.data.CardInsName);//英汉卡名字\r\n\t\t\t\t\t\t\t\t\t\t\t$(\"#id-BankType\").val(result.data.BankCardType);//银行卡类型\r\n//\t\t\t\t\t\t\t\t\t\t\tif(result.data.CardInsName==\"中信银行\"){\r\n//\t\t\t\t\t\t\t\t\t\t\t\t$(\"#bank\").attr(\"bankkey\",\"CITICINDUB\");\r\n//\t\t\t\t\t\t\t\t\t\t\t}\r\n//\t\t\t\t\t\t\t\t\t\t\tif(result.data.CardInsName==\"工商银行\"){\r\n//\t\t\t\t\t\t\t\t\t\t\t\t$(\"#bank\").attr(\"bankkey\",\"INDU&COMMB\");\r\n//\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n//\t\t\t\t\t\t\t\t\t    }\r\n//\t\t\t\t\t\t\t    \t\telse{\r\n//\t\t\t\t\t\t\t    \t\t\tmui.alert(\"现阶段只支持中信银行和工商银行\");\r\n//\t\t\t\t\t\t\t    \t\t}\r\n\t\t\t\t\t\t\t    //\t}\r\n\t\t\t\t\t\t\t    \t\r\n\t\t\t\t\t         //  })\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\tscanBankCardInfo();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\tmui.alert(\"确认银行卡信息发生错误:\"+result.data.errormsg);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},result.data)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tmui.alert(\"扫描银行卡信息失败:\"+result.data.errormsg);\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t})\r\n\t}\r\n//扫描银行卡结束"],"sourceRoot":"/source/"}